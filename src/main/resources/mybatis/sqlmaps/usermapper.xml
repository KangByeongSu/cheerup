<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="UserMapper">
	<select id="checkUser" parameterType="com.skplanet.project2.model.UserDTO"
		resultType="com.skplanet.project2.model.UserDTO">
		select
		count(*) as count,
		IFNULL(u_nickname, '') as
		uNickname
		FROM
		Elephant_User user
		WHERE
		u_id=#{uId} and u_pw=#{uPw}
	</select>

	<resultMap id="ImageGridMap" type="com.skplanet.project2.model.ImageGridDTO">
		<result property="contentId" column="c_id" />
		<result property="imgUrl" column="c_imgurl" />
	</resultMap>
	<select id="userImageGridURL" parameterType="String" resultMap="ImageGridMap">
		select c_id as contentId, c_imgurl as imgUrl
		from Elephant_Contents
		where
		Elephant_User_u_id=#{userId};
	</select>

	<select id="likeCount" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM Elephant_Like where
		Elephant_Contents_c_id=#{contentId};
	</select>

	<select id="commentCount" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM Elephant_Comment where
		Elephant_Contents_c_id=#{contentId};
	</select>


	<select id="extendModalContents" parameterType="Integer"
		resultType="com.skplanet.project2.model.DetailViewDTO">
		SELECT c_id as id, Elephant_User_u_id as userId,
		c_comment
		as comment, c_imgurl as imgUrl, c_time as time FROM
		Elephant_Contents
		WHERE c_id=#{contentId};
	</select>

	<select id="extendModalLikeCount" parameterType="Integer"
		resultType="Integer">
		SELECT count(*) FROM
		Elephant_Like
		WHERE Elephant_Contents_c_id=#{contentId};
	</select>

	<select id="extendModalLikeClicked" parameterType="com.skplanet.project2.model.LikeDTO"
		resultType="Integer">
		SELECT count(*) FROM
		Elephant_Like
		WHERE Elephant_Contents_c_id=#{contentId} AND Elephant_User_u_id=#{userId};
	</select>


	<select id="extendModalComment" parameterType="Integer"
		resultMap="CommentsMap">
		SELECT cm_id as commentId, Elephant_User_u_id as userId,
		Elephant_Contents_c_id
		as feedId, cm_time as time, cm_content as
		message FROM
		Elephant_Comment
		WHERE Elephant_Contents_c_id=#{contentId};
	</select>

	<resultMap id="CommentsMap" type="com.skplanet.project2.model.CommentDTO">
		<result property="commentId" column="cm_id" />
		<result property="userId" column="Elephant_User_u_id" />
		<result property="feedId" column="Elephant_Contents_c_id" />
		<result property="time" column="cm_time" />
		<result property="message" column="cm_content" />
	</resultMap>


	<update id="updateUser" parameterType="com.skplanet.project2.model.UserDTO">

		update
		Elephant_User

		set
		u_nickname=#{uNickname},u_pw=#{uPw}

		where
		u_id=#{uId}

	</update>

</mapper>